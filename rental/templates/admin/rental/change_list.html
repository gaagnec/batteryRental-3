{% extends "admin/change_list.html" %}
{% load i18n %}

{% block extrahead %}
  {{ block.super }}
  <style>
    /* Hide default right sidebar filter */
    #changelist-filter { display: none !important; }
    /* Make content area full width */
    #content { max-width: 100%; }
    /* Remove reserved space for sidebar when filters exist */
    #changelist.filtered .results,
    #changelist.filtered .paginator,
    #changelist.filtered .actions { margin-right: 0 !important; }
    .table-responsive { overflow-x: auto; }
    .top-scroll { overflow-x: auto; height: 16px; margin-bottom: .25rem; }
    .top-scroll .spacer { height: 1px; }
    /* Make headers wrap to allow two-line labels */
    #result_list thead th { white-space: normal; word-break: break-word; vertical-align: middle; }
    #result_list thead th .two-lines { display: inline-block; line-height: 1.1; }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const tbl = document.getElementById('result_list');
      if (tbl) {
        tbl.classList.add('table','table-sm','table-hover','table-striped');
        const hdrWeekly = tbl.querySelector('th.column-weekly_rate');
        if (hdrWeekly) hdrWeekly.innerHTML = 'Weekly <br><span class="two-lines">rate</span>';
        const hdrCode = tbl.querySelector('th.column-contract_code');
        if (hdrCode) hdrCode.innerHTML = 'Contract <br><span class="two-lines">code</span>';
      }
    });
  </script>
{% endblock %}

{% block object-tools-items %}
  {# Centered filter controls replacing sidebar filters #}
  <li class="d-flex w-100 justify-content-center" style="list-style:none;">
    <div class="btn-group btn-group-sm" role="group" aria-label="Filters">
      {% with cur=request.GET.status__exact %}
        <a class="btn {% if not cur %}btn-secondary{% else %}btn-outline-secondary{% endif %}" href=".">{% trans "All" %}</a>
        <a class="btn {% if cur == 'active' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="?status__exact=active">Активен</a>
        <a class="btn {% if cur == 'modified' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="?status__exact=modified">Модифицирован</a>
        <a class="btn {% if cur == 'closed' %}btn-primary{% else %}btn-outline-primary{% endif %}" href="?status__exact=closed">Закрыт</a>
      {% endwith %}
    </div>
  </li>
  {{ block.super }}
{% endblock %}

{% block result_list %}
  <div class="table-responsive">
    {{ block.super }}
  </div>
{% endblock %}
