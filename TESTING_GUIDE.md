# Руководство по тестированию улучшений страницы платежей

## Что было изменено

На странице добавления платежа (`/admin/rental/payment/add/`) были внесены следующие улучшения:

1. ✅ **Фильтрация договоров** - по умолчанию показываются только активные договора последней версии
2. ✅ **Галочка "Показать все договора"** - позволяет увидеть все договора
3. ✅ **Сортировка** - договора отсортированы от большего ID к меньшему
4. ✅ **Темная тема** - применен стиль как на dashboard
5. ✅ **Переименование** - поле "Rental" теперь называется "Аренда"

## Шаги для тестирования

### 1. Подготовка
```bash
cd /workspace/batteryRental-3
git checkout payment-page-improvements
python manage.py runserver 0.0.0.0:43044
```

### 2. Проверка отображения по умолчанию
1. Откройте браузер и перейдите на: `http://localhost:43044/admin/rental/payment/add/`
2. Найдите поле "Аренда" (раньше называлось "Rental")
3. Откройте выпадающий список
4. **Ожидаемый результат**: отображаются только активные договора последней версии
5. **Проверьте**: договора отсортированы от большего номера к меньшему

### 3. Проверка темной темы
1. На той же странице обратите внимание на цветовую схему
2. **Ожидаемый результат**: 
   - Фон темный (#0b0d1a)
   - Карточки темные (#1c1e2d)
   - Текст светлый (#e3e6ed)
   - Стиль похож на `/admin/dashboard/`

### 4. Проверка галочки "Показать все договора"
1. Найдите чекбокс "Показать все договора" в верхней части формы
2. **Ожидаемый результат**: 
   - Под чекбоксом есть пояснение
   - Есть информационный badge "Отображаются только активные договора"
3. Установите галочку
4. **Ожидаемый результат**: 
   - Страница перезагрузится
   - В URL появится параметр `?show_all_rentals=1`
   - Badge изменится на "Отображаются все договора"
5. Откройте выпадающий список "Аренда"
6. **Ожидаемый результат**: теперь отображаются ВСЕ договора (включая закрытые)

### 5. Проверка сохранения состояния
1. С установленной галочкой выберите договор
2. Заполните другие поля (сумма, дата и т.д.)
3. Если вы не хотите сохранять платеж, просто обновите страницу
4. **Ожидаемый результат**: галочка остается установленной (сохранена в URL)

### 6. Проверка переключения обратно
1. Снимите галочку "Показать все договора"
2. **Ожидаемый результат**: 
   - Страница перезагрузится
   - Параметр `show_all_rentals` исчезнет из URL
   - Снова отображаются только активные договора

### 7. Проверка редактирования существующего платежа
1. Перейдите к списку платежей: `/admin/rental/payment/`
2. Откройте любой существующий платеж для редактирования
3. **Ожидаемый результат**: 
   - Темная тема применена
   - Галочка "Показать все договора" доступна
   - Поле называется "Аренда"

## Что проверить дополнительно

### Совместимость
- [ ] Все существующие функции работают (AJAX загрузка информации о договоре, быстрый выбор суммы и т.д.)
- [ ] Нет JavaScript ошибок в консоли браузера (F12)
- [ ] Форма корректно сохраняется

### Производительность
- [ ] Страница загружается быстро
- [ ] Переключение галочки происходит без задержек
- [ ] Выпадающий список открывается быстро

### Разные сценарии
- [ ] Работает на мобильных устройствах
- [ ] Работает в разных браузерах (Chrome, Firefox, Safari)
- [ ] Работает для разных типов пользователей (admin, moderator и т.д.)

## Если что-то не работает

1. Проверьте консоль браузера (F12) на наличие ошибок
2. Проверьте логи сервера Django
3. Убедитесь, что вы находитесь на правильной ветке: `git branch`
4. Убедитесь, что все файлы сохранены: `git status`

## Откат изменений (если нужно)

Если что-то пошло не так:
```bash
git checkout main
python manage.py runserver 0.0.0.0:43044
```

## Вопросы?

Если у вас возникли вопросы или проблемы, пожалуйста:
1. Проверьте файл PAYMENT_PAGE_IMPROVEMENTS.md для технических деталей
2. Просмотрите изменения: `git diff main payment-page-improvements`
3. Создайте issue с описанием проблемы
